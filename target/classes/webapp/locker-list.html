<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Locker List</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .inuse-status { background-color: #28a745; color: #fff; }
    .pending-status { background-color: #ffc107; color: #000; }
    .completed-status { background-color: #007bff; color: #fff; }
    .default-status { background-color: #6c757d; color: #fff; }
    .hidden { display: none; }

    h2 {
      font-family: 'Roboto', sans-serif; 
      font-weight: 700; 
      color: #FFD306; 
    }

    .idle-status {
      background-color: #007bff;
      color: #fff !important;
      font-weight: bold !important;
    }

    .inuse-status {
      background-color: #ffc107;
      color:  #fff !important;
      font-weight: bold !important;
    }
  </style>
</head>
<body>

<div class="container mt-5" th:fragment="content">
  <h2 class="mb-4">Locker List</h2>
  <div>
    <table class="table">
      <thead>
        <tr>
          <th scope="col">名稱</th>
          <th scope="col">狀態</th>
          <th scope="col">位置</th>
          <th scope="col">到期時間</th>
        </tr>
      </thead>
      <tbody>
        <!-- 使用 thymeleaf 動態產出 box list -->
        <tr th:each="box : ${boxes}">
          <td>
            <!-- 判斷 box.status，若為 'UA' 則不產生超連結 -->
            <span th:unless="${box.status == 'UA'}">
              <a th:href="@{'/api/Boxes/' + ${box.id}}"> 
                <span th:text="${box.name}"></span>
              </a>
            </span>
            <!-- 若為 'UA' 則直接顯示名稱 -->
            <span th:if="${box.status == 'UA'}" th:text="${box.name}"></span>
          </td>
          <td>
            <span class="badge rounded"
              th:class="|${box.status == 'A' ? 'idle-status' : ''} ${box.status == 'UA' ? 'inuse-status' : ''} ${box.status == 'A' ? 'completed-status' : 'default-status'}|"
              th:text="${box.status == 'A' ? '空閒中' : (box.status == 'UA' ? '使用中' : '其他狀態')}"></span>
            <!-- 如果 box 狀態為 'Active'，則顯示 user id -->
            <!-- <span th:if="${box.status == 'In-use' and box.userId != null}" th:text="' (User ID: ' + ${box.userId} + ')'"></span> -->
          </td>
          <!-- 修改 box 位置的超連結，直接指向 box-map.html -->
          <td>
            <!-- 判斷 box.status，若為 'UA' 則不產生超連結 -->
            <a th:if="${box.status != 'UA'}" th:href="@{'/api/Boxes/' + ${box.id} + '/location'}">
              <button class="btn btn-link" type="button" th:text="${box.location}"></button>
            </a>
            <!-- 若為 'UA' 則不產生超連結 -->
            <span th:unless="${box.status != 'UA'}" th:text="${box.location}"></span>
          </td>
          <td th:utext="${#temporals.format(box.expiryTime, 'yyyy-MM-dd HH:mm:ss')}"></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
