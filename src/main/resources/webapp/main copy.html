<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>台灣地圖</title>
  <style>
    /* 設定 SVG 地圖的寬度和高度 */
    svg {
      width: 100%;
      height: 100%;
    }
    /* 設定火車站的樣式 */
    .station {
      fill: red;
      stroke: white;
      stroke-width: 2px;
    }
  </style>
  <!-- 引用 D3.js -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <!-- 建立 SVG 地圖 -->
  <svg></svg>

  <script>
    // 設定 SVG 地圖的寬度和高度
    const width = window.innerWidth;
    const height = window.innerHeight;

    // 建立 SVG 地圖
    const svg = d3.select('svg')
                  .attr('width', width)
                  .attr('height', height);

    // 載入台灣地圖的 GeoJSON 檔案
    d3.json('https://gist.githubusercontent.com/kiang/3b3a3ab3b7a7a7c5e4f8/raw/taiwan.json')
      .then(function(geojson) {
        // 設定投影方式
        const projection = d3.geoMercator()
                             .fitSize([width, height], geojson);

        // 建立路徑產生器
        const path = d3.geoPath()
                       .projection(projection);

        // 繪製台灣地圖
        svg.selectAll('path')
           .data(geojson.features)
           .enter()
           .append('path')
           .attr('d', path)
           .attr('fill', 'none')
           .attr('stroke', 'black');

        // 設定火車站的資料
        const stations = [
          { name: '台北', lat: 25.047924, lng: 121.517081 },
          { name: '板橋', lat: 25.014412, lng: 121.463853 },
          { name: '桃園', lat: 25.013947, lng: 121.215358 },
          { name: '新竹', lat: 24.801961, lng: 120.971725 },
          { name: '台中', lat: 24.136829, lng: 120.685011 },
          { name: '嘉義', lat: 23.479712, lng: 120.435446 },
          { name: '台南', lat: 22.998745, lng: 120.218257 },
          { name: '高雄', lat: 22.627278, lng: 120.301435 },
          { name: '屏東', lat: 22.669167, lng: 120.4925 }
        ];

        // 在地圖上標示火車站
        svg.selectAll('circle')
           .data(stations)
           .enter()
           .append('circle')
           .attr('cx', function(d) { return projection([d.lng, d.lat])[0]; })
           .attr('cy', function(d) { return projection([d.lng, d.lat])[1]; })
           .attr('r', 5)
           .attr('class', 'station')
           .append('title')
           .text(function(d) { return d.name; });
      });
  </script>
</body>
</html>
